## Databinding (зв'язування даних)

### Терміни

-   Датабіндинг (зв'язування даних) — механізм синхронізації даних та відображення
-   Дані — будь-яка інформація, незалежно від способу подання
-   Відображення — частина інтерфейсу, незалежно від способу реалізації

### MVC

-   Model (модель) — дані (сховище бізнес-логіки зав'язаної на перетворенні даних)
-   View (вигляд) — компоненти
-   Controller (контролер) — поведінка (сховище бізнес-логіки зав'язаної на поведінці)

Бизнел логіка в BigTrip зав'язана на поведінці,
а за поведінку відповідає презентер

Модель буде відповідати за преобазовання даних,
якщо маємо логіку зав'язану на преобразованні,
тоді так в модель буде бізнес логіка

### Ієрархія MVC

#### Model

-   Плоска структура — всі моделі знаходяться на одному рівні
-   Ієрархічна структура — існують моделі вкладені в інші моделі. Як правило, батьківськими моделями є «колекції», для роботи з великим кількістю записів (приклад — Backbone.js)

#### View

-   Плоска структура View — всі View ініціалізуються в одному контролері та взаємодіють безпосередньо з ним
-   Ієрархічні View — одні View додаються всередину інших View і самостійно вибудовують свою ієрархію. Батьківські View можуть передплатити події дочірніх та інтерпретувати їх по-своєму

#### Controller

-   Мега-контролер — один великий контролер на весь додаток (або на кожен екран), який повністю описує всю бізнес-логіку
-   HMVC — система, в якій є безліч вкладених один в одного контролерів, які виступають як абстракції для вищих рівнів (контролер списку контролер елемента)

### Види MV\*

#### MVC

-   Model — працює лише з даними. Керує відображенням
-   View — відповідає строго за відображення. Слабко пов'язаний компонент
-   Controller — створює модель та відображення та знайомить їх між собою, далі модель та відображення спілкуються безпосередньо

#### MVP

-   Model — працює лише з даними. Слабко пов'язаний компонент
-   View — відповідає строго за відображення. Слабко пов'язаний компонент
-   Presenter — створює модель та відображення, після чого відповідає за зв'язування їх між собою. Підписується на зміни моделі та відображення, слухає зміни у кожному з них і викликає оновлення

#### MVVM

-   Model — працює лише з даними
-   View — відповідає строго за відображення
-   ViewModel — отримує модель та відображення після чого зв'язує їх через біндінг, завдяки якому стан моделі та відображення синхронізується автоматично

### Введення користувача у MV\*

#### MVC

-   Користувач взаємодіє з відображенням
-   Відображення повідомляє контролеру про дію користувача
-   Контролер викликає зміну моделі
-   Модель оновлює відображення через підписку

#### MVP

-   Користувач взаємодіє з відображенням
-   Відображення повідомляє перезнтер про дію користувача
-   Перезнтер запускає логіку оновлення моделі
-   Модель повідомляє перезнтер
-   Перезнтер оновлює відображення

#### MVVM

-   Користувач взаємодіє з відображенням
-   Відображенням оновлює модель через зв'язок описаний у ViewModel

### Завантаження у MV\*

#### MVC

-   Контролер викликає оновлення моделі
-   Модель завантажує дані та сповіщає відображення про свої зміни

#### MVP

-   Перезнтер запускає логіку оновлення моделі
-   Модель повідомляє перезнтер
-   Перезнтер оновлює відображення

#### MVVM

-   Модель після завантаження синхронізується з відображенням через біндінг, описаний у ViewModel

### Low coupling (слабке зв'язування)

Як модель, так і уявлення повинні бути абстрактними і не повинні, по-перше, нічого не знати один про одного, по-друге, повинні надавати назовні лише абстрактний інтерфейс. Слабке зв'язування не може існувати без high cohesion (високого зачеплення). Якщо існують абстрактні, слабко пов'язані модулі, має з'явитися логіка, яка відповідає за зв'язування їх у єдине ціле

### Підводні камені

-   Обробка введення користувача: користувач може ввести небезпечні для відображення дані та інтерфейс повинен бути стійкий до цього
-   Зберігання та передача даних може відбуватися не в тому ж вигляді, в якому дані використовуються на сайті, тому у додатку потрібно постійно конвертувати дані з одного формату до іншого
-   Деякі вбудовані в ES об'єкти (дати, множини, словники) не можна конвертувати в JSON тому доводиться перетворювати їх на стандартні типи даних (примітиви, масиви, об'єкти)
