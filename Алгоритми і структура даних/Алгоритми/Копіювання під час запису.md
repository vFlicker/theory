# Копіювання під час запису

Якщо ресурс дублюється, але не змінюється, немає потреби створювати новий ресурс; ресурс може використовуватись спільно копією та оригіналом. Модифікації все одно повинні створювати копію, звідси й техніка: операція копіювання відкладається до першого запису. Спільне використання ресурсів, таким чином, дозволяє значно знизити споживання ресурсів немодифікованими копіями, додаючи при цьому невеликі накладні витрати на операції зі зміни ресурсів.

Мова Swift надає механізм, який копіює поведінку типів посилань на типи значень до перших змін, такий механізм і називається COW. Це позбавляє нашу програму зайвих копіювань, тим самим покращуючи продуктивність.

```swift
func address(o: UnsafeRawPointer) {
  print("address: \(Int(bitPattern: o))")
}

var arr1 = [1, 2, 3]
var arr2 = arr1

arr2.append(4)

address(arr1) // address: 105553154755744
address(arr2) // address: 105553135788672
```
