# MongoDB

MongoDB — це система управління базами даних (СУБД) з відкритим вихідним кодом, орієнтована на роботу з документами і не вимагає жорсткої схеми даних.

## Особливості MongoDB

- JSON-подібне сховище (документ).
- Масштабованість.
- Доступність (може бути розміщена на декількох серверах).
- Ефективна система індексації (текст, координати, дати).
- Eventually Consistency — забезпечує узгодженість даних в розподіленій базі.
- Файлове сховище.
- Зручний клієнт з API.

## Запуск MongoDB сервера

1. Створити директорію для зберігання даних.
2. Задати порт: `--port 27017`.
3. Вказати шлях до директорії: `--dbpath=./data`.
4. Запустити сервер: `mongod --port 27017 --dbpath=./data`.

## Клієнт для роботи з базою даних

- Підключається до бази даних.
- Слідкує за підключенням до бази даних.
- Використовує внутрішній протокол для взаємодії з базою даних.
- Надає зручний API для розробника.

## Базові поняття

- Database (база даних) — сервер може містити декілька баз даних. Звертання до конкретної бази відбувається за допомогою вказівки імені бази даних.
- Collection (колекція) — набір однотипних даних (аналогія таблиці).
- Cursor (курсор) — ітератор для обмеження чи керування даними при їх отриманні.

## Selector (об'єкт запиту)

Їхня основна функція — це шаблон об'єкту, який вказує, які дані потрібно знайти. Наприклад, `{ email: "test@gmail.com" }` слід читати як:

- Знайди в колекції об'єкти, у яких є поле `email`.
- Відфільтруй серед них ті об'єкти, значення поля `name` яких дорівнює `test@gmail.com`.

## Базові операції в MongoDB

### Читання

Метод `find()`:

- Приймає об'єкт запиту у вигляді JSON.
- Повертає Cursor з отриманими даними.

### Запис

Методи `insertOne()` та` insertMany()`:

- `insertOne()` — приймає об'єкт та записує його до колекції.
- `insertMany()` — приймає масив об'єктів і записує їх у колекцію по одному.
- Обидва методи повертають об'єкт із результатом операції або викидають помилку.

### Оновлення

Методи `updateOne()` та `updateMany()`:

- `updateOne()` — приймає два об'єкти — один для запиту, інший з параметрами оновлення.
- `updateMany()` — приймає два об'єкти — один для запиту, інший з параметрами оновлення.
- Обидва методи повертають об'єкт із результатом операції або викидають помилку.

Метод `updateMany()`:

- Приймає два об'єкти — один для запиту, інший з параметрами оновлення.
- Повертає об'єкт із результатом операції або викидає помилку.

### Видалення

Методи `deleteOne()` та `deleteMany()`:

- `deleteOne()` — приймає об'єкт запиту.
- `deleteMany()` — приймає об'єкт запиту.
- Обидва методи повертають об'єкт із результатом операції або викидають помилку.

## GridFS

Розподілена файлова система, побудована поверх MongoDB, яка автоматично розбиває дані на частини (chunks). Має зручний інтерфейс для роботи з файлами.

## Підключення

```js
const { MongoClient } = require("mongodb");

const url = "mongodb://localhost:27017";

const connectAndRead = async () => {
  const client = await MongoClient.connect(url);
  const db = client.db("my-fancy-game");
  const collection = db.collection("wizards");
  client.close();
};

try {
  connectAndRead();
} catch (error) {
  throw error;
}
```
