# JWT

JWT (JSON Web Token) — це ефективний та самостійний метод безпечної передачі інформації у форматі JSON між сторонами, з можливістю перевірки та довіри завдяки цифровому підпису.

## Використання JWT

- Авторизація — основний сценарій — після входу користувача кожен наступний запит включає JWT, який дає доступ до дозволених ресурсів та маршрутів.
- Обмін інформацією — JWT використовується для безпечної передачі даних між сторонами завдяки цифровому підпису.

## Типи токенів

- Access token (Токен доступу) — короткочасний токен для отримання доступу до захищених ресурсів, містить інформацію, таку як час життя та IP-адреса відправника запиту.
- Refresh token (Токен оновлення) — використовується для отримання нового токену доступу, має довший термін дії і може бути використаний лише один раз.

### Використання Refresh token

При закінченні терміну дії JWT відправляється RT, отримуючи нову пару JWT та RT, зменшуючи затримку при звертанні до серверу авторизації.

## Структура JWT

- Header (Заголовок) — містить тип токена (JWT) та використовуваний алгоритм підпису (наприклад, HMAC SHA256 або RSA).

```json
{
  "alg": "HS256",
  "typ": "JWT"
}
```

- Payload (Корисне навантаження) — містить інформацію про сутність, таку як дані користувача.

```json
{
  "sub": "1234567890",
  "name": "John Doe",
  "admin": true
}
```

Слід зазначити, що для підписаних токенів ця інформація, хоч і захищена від підробки, доступна для читання будь-кому. Секретна інформація не повинна розміщуватися в елементах корисного навантаження або заголовку JWT, якщо вони не зашифровані.

- Signature (Підпис) — використовується для перевірки цілісності та автентичності токена. Підписується закодований заголовок, закодоване корисне навантаження та секретний ключ.

```js
const unsignedToken = `${base64urlEncode(header)}.${base64urlEncode(payload)}`;
const SECRET_KEY = "cAtwa1kkEy";
const signature = HMAC - SHA256(unsignedToken, SECRET_KEY);

const token = [
  encodeBase64Url(header),
  encodeBase64Url(payload),
  encodeBase64Url(signature),
].join(".");
```
