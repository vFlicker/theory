# CORS (Cross-Origin Resource Sharing / Спільне використання ресурсів між джерелами)

CORS — це механізм сучасних браузерів, який дозволяє веб-сторінкам отримувати доступ до ресурсів іншого домену. Запити можуть бути двох видів: «прості» та «непрості». Основна відмінність між ними полягає в тому, як вони виконуються та обробляються браузером.

## «Прості» запити

Прості запити включають методи GET, POST, HEAD та певні заголовки, такі як `Accept`, `Accept-Language`, `Content-Language`, `Content-Type` зі значенням `application/x-www-form-urlencoded`, `multipart/form-data або text/plain`.

Для простих запитів:

1. Браузер надсилає запит із заголовком `Origin`, який містить джерело.
   - Для запитів без авторизаційних даних, сервер повинен встановити:
     - `Access-Control-Allow-Origin` в `*` або те саме значення, що і `Origin`.
   - Для запитів з авторизаційними даними, сервер також має встановити:
     - `Access-Control-Allow-Credentials` у `true`.
     - При необхідності дозволити JavaScript доступ до додаткових заголовків відповіді, сервер повинен перерахувати їх у заголовку `Access-Control-Expose-Headers`.

## «Непрості» запити

Непрості запити перед виконанням основного запиту включають попередній запит OPTIONS:

1. Браузер надсилає OPTIONS запит на ту саму адресу з наступними заголовками:
   - `Access-Control-Request-Method`, що містить запитуваний метод.
   - `Access-Control-Request-Headers`, що перераховує «непрості» запитувані заголовки.
2. Сервер повинен відповісти статусом 200 та надати такі заголовки:
   - `Access-Control-Allow-Methods` із списком дозволених методів.
   - `Access-Control-Allow-Headers` із списком дозволених заголовків.
   - `Access-Control-Max-Age` із кількістю секунд для кешування дозволів.
3. Після цього виконується основний запит за «простою» схемою.

## Приклад CORS middleware в Express

```js
app.use((req, res, next) => {
  res.header("Access-Control-Allow-Origin", "*");
  res.header(
    "Access-Control-Allow-Headers",
    "Origin, X-Requested-With, Content-Type, Accept"
  );
  next();
});
```

Цей middleware для Express дозволяє будь-якій сторінці отримувати доступ до ресурсів з будь-якого джерела, встановлюючи відповідні заголовки. Обов'язково зазначте конкретні дозволені заголовки та джерела, якщо це можливо для вашого застосунку.
