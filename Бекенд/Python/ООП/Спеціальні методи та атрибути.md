# Спеціальні методи та атрибути

У Python існують спеціальні атрибути, імена яких починаються і закінчуються двома знаками підкреслення. Їх використовує інтерпретатор Python для доступу до внутрішньої інформації про об'єкти та керування їх поведінкою.

## Життєвий цикл об'єкта

### `__new__(cls, [...])`

Метод `__new__` викликається перед `__init__` при створенні нового об'єкта. Він відповідає за створення та повернення нового об'єкта. Рідко перевизначається, використовується, наприклад, для зміни поведінки створення об'єкта для незмінних (immutable) класів.

### `__init__(self, [...])`

Метод `__init__` викликається після `__new__` та відповідає за ініціалізацію об'єкта. Приймає екземпляр класу та параметри, передані конструктору. Тут можна виконати всі необхідні налаштування та ініціалізації атрибутів об'єкта.

### `__del__(self)`

Метод `__del__` викликається, коли об'єкт видаляється з пам'яті. Час виклику цього методу може бути непередбачуваним, тому його використання не рекомендується.

## Контроль доступу до атрибутів

### `__getattr__(self, name)`

Цей метод викликається, коли спроба доступу до атрибута, який не існує. Можна визначити поведінку для таких випадків, наприклад, для перехоплення та повідомлення про використання застарілих атрибутів.

### `__setattr__(self, name, value)`

Метод `__setattr__` викликається при спробі встановити значення атрибуту та дозволяє визначити правила для присвоєння значень атрибутам.

**Обережно!**

Нижче приклад приведе до нескінченної рекурсії. Кожного разу, коли в методі `__setattr__()` виконується `self.name = value`, знову буде викликано метод `__setattr__()` і так до тих пір, поки не переповниться стек викликів.

```py
class A:
    def __setattr__(self, name, value):
        self.name = value
```

У кожного класу є спеціальний атрибут `__dict__`, який є словником, що містить усі атрибути та їх значення. Тому можна уникнути рекурсії та працювати з атрибутами напряму:

```py
class A:
    def __setattr__(self, name, value):
        self.__dict__[name] = value
```

### `__delattr__`

Цей метод викликається при спробі видалити атрибут. Визначає поведінку для видалення атрибутів.

### `__getattribute__(self, name)`

Цей метод викликається при кожній спробі доступу до атрибута (не тільки до неіснуючих). Рідко використовується, оскільки може призвести до складних помилок та небажаних наслідків.

## Інші спеціальні методи та атрибути

Є багато інших спеціальних атрибутів, які можна використовувати в класах Python.

-   `__doc__` — містить документацію класу або функції.
-   `__module__` — назва модуля, в якому визначено клас або функцію.
-   `__dict__` — словник, що містить атрибути об'єкта.
-   `__class__` — клас об'єкта.
-   `__str__()` — визначає поведінку функції `str()`, коли вона викликається для об'єкта.
