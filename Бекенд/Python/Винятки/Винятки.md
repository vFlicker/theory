# Винятки

Винятки — це механізм обробки помилок або непередбачених ситуацій під час виконання програми. Вони дозволяють програмі працювати з помилками, відловлюючи їх та надаючи можливість виконати певні дії для їх виправлення або обробки.

## Переваги використання винятків

-   Збільшення надійності програми: Винятки дозволяють обробляти помилки та запобігати аварійному завершенню програми.
-   Покращення коду: Винятки допомагають писати більш чистий та організований код, оскільки логіка обробки помилок відділена від основної логіки програми.
-   Підвищення читабельності коду: Винятки роблять код більш читабельним, оскільки чітко вказують на можливі помилки.

## Ієрархія винятків

Винятки в Python мають ієрархію класів, і базовий клас для всіх винятків називається `BaseException`. Всі інші винятки успадковуються від цього класу. Зазвичай винятки можна розділити на дві категорії.

### Вбудовані винятки

Вбудовані винятки — винятки, які вже визначені в мові Python:

-   `ZeroDivisionError` — виникає, коли намагаються поділити на нуль.
-   `TypeError` — виникає, коли виконується операція з типами даних, які не є сумісними.
-   `ValueError` — виникає, коли ім'я змінної не знайдено.

### Користувацькі винятки

Користувацькі винятки — винятки, які ви можете визначити самостійно, створивши новий клас винятку, який успадковується від вбудованих класів винятків.

```py
class MyError(Exception):
    def __init__(self, message):
        self.message = message
        super().__init__(message)
```

## Викидання винятків

Для викидання винятку використовується ключове слово `raise`.

```py
try:
    raise MyError("This is my own error text.")
except MyError as error:
    print(f"An MyError occurred: {error.message}")
```

### Передача винятків на один рівень вгору

Для того, щоб в обробнику винятка виконати певні дії, а потім передати виняток далі, на один рівень обробників вище (тобто, викинути той самий виняток ще раз), використовується інструкція `raise` без параметрів.

```py
try:
    do_some_actions() # дії, які можуть призвести до винятка
except Exception as exception: # обробник винятка
    handle_exception(exception) # певні дії з перехопленим винятком
    raise
```

## Обробка винятків

Для обробки винятків використовують конструкцію `try-except`.

**Приклад**

```py
try:
    # Код, який може викликати виняток
    result = 10 / 0
except ZeroDivisionError:
    # Обробка винятку типу ZeroDivisionError
    result = "Ділення на нуль недопустиме"
except Exception as error:
    # Обробка винятків будь-якого іншого типу
    result = f"Виникла помилка: {error}"
else:
    # Виконається, якщо виняток не виник
    result = "Все пройшло успішно"
finally:
    # Виконається завжди, незалежно від того, чи виникла помилка
    cleanup()
```

-   Блок `try` містить код, який може викликати помилки. Якщо при виконанні інструкцій в даному блоці було піднято виняток, їх виконання переривається і керування переходить до одного з обробників. Якщо не виникло жодного винятка, блоки `except` пропускаються.
-   Блоки `except` вказують, як обробляти різні типи помилок. Якщо після `except` нічого не вказати, то будуть перехоплені усі винятки які ми не перехопили раніше. Бажано уникати такого перехоплення винятків, треба перехоплювати конкретні винятки.
-   Блок `else` виконується, якщо жодна помилка не виникла в блоку `try`.
-   Блок `finally` виконується завжди, незалежно від того, чи виникла помилка чи ні. Зазвичай використовується для виконання так званих «дій по очистці» (cleanup actions), тобто дій, направлених на звільнення ресурсів: закриття файлів, видалення тимчасових об'єктів, тощо.

### Послідовність блоків `except`

Блоки `except` обробляються від гори до низу і керування передається не більше, ніж одному обробнику. Тому при необхідності по-різному обробляти винятки, які знаходяться в ієрархії успадкування, спочатку треба вказувати обробники менш загальних винятків, а потім — більш загальних.

У наступному коді ми ніколи не перехопимо ділення на нуль.

```py
try:
    1/0
except Exception:
    print('Some exception catched')
except ZeroDivisionError:
    print('Zero division catched')
```
