# Менеджер контексту

Менеджер контексту (context manager) — це універсальний механізм в Python для автоматичного керування ресурсами. Вони використовуються для виконання певного коду в рамках контексту, а потім звільнення ресурсів, які використовувалися в цьому контексті.

## Переваги використання менеджерів контексту

-   Зручність: Вам не потрібно вручну відкривати та закривати ресурси.
-   Читабельність: Завдяки конструкції `with` код стає більш читабельним та зрозумілим.
-   Безпека: Менеджери контексту гарантують, що ресурси будуть звільнені, навіть якщо виникає виняток.

## Приклади використання

### Без менеджера контексту

```py
opened_file = open('some_file.txt', 'w')

try:
    opened_file.write('Hello!')
finally:
    opened_file.close()
```

### З менеджером контексту

```py
with open('some_file.txt', 'w') as opened_file:
    opened_file.write('Hello!')
```

## Створення менеджеру контексту

Менеджер контексту визначається через реалізацію двох методів: `__enter__` та `__exit__`.

-   `__enter__`: Метод, що відповідає за початкову налаштування контексту та повернення значення, яке буде пов'язане з `as` у конструкції `with`. Може відкрити файл, встановити з'єднання з базою даних або зарезервувати ресурси.
-   `__exit__`: Метод, який викликається після завершення виконання блоку коду в межах контексту. Він використовується для звільнення ресурсів та обробки винятків. Може закрити файл, від'єднатися від бази даних або звільнити зарезервовані ресурси.

```py
from os import chdir, getcwd


class cd:
    def __init__(self, path):
        self.path = path

    def __enter__(self):
        # Логіка для відкриття ресурсу

        self.old_path = getcwd()
        chdir(self.path)

    def __exit__(self, exc_type, exc_value, traceback):
        # Логіка для закриття ресурсу
        # exc_type, exc_value, traceback — використовуються для обробки винятків, якщо вони виникають

        chdir(self.old_path)
        return False


print(getcwd())  # D:\Vlad\Programming\Python\

with cd("/"):
    print(getcwd())  # D:\

print(getcwd())  # D:\Vlad\Programming\Python\
```
